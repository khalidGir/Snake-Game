<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="snake.css" />
    <title>Snake Game</title>
    <!-- Removed inline styles to use external CSS -->
  </head>
  <body>
    <div class="score" id="scoreDisplay">Score: 0</div>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <div class="game-over" id="gameOver" style="display: none">
      <h1>Game Over</h1>
      <button onclick="restartGame()">Restart</button>
    </div>
    <script>
      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d");
      const scoreDisplay = document.getElementById("scoreDisplay");
      const gameOverDiv = document.getElementById("gameOver");

      const gridSize = 20;
      const tileCount = canvas.width / gridSize;

      let snake = [{ x: 10, y: 10 }];
      let direction = { x: 0, y: 0 };
      let food = {
        x: Math.floor(Math.random() * tileCount),
        y: Math.floor(Math.random() * tileCount),
      };
      let score = 0;
      let gameActive = true;

      function gameLoop() {
        if (!gameActive) return;
        update();
        draw();
        setTimeout(gameLoop, 100);
      }

      function update() {
        const head = {
          x: snake[0].x + direction.x,
          y: snake[0].y + direction.y,
        };

        if (
          head.x < 0 ||
          head.x >= tileCount ||
          head.y < 0 ||
          head.y >= tileCount ||
          snake.some((segment) => segment.x === head.x && segment.y === head.y)
        ) {
          showGameOver();
          return;
        }

        snake.unshift(head);

        if (head.x === food.x && head.y === food.y) {
          score++;
          food = {
            x: Math.floor(Math.random() * tileCount),
            y: Math.floor(Math.random() * tileCount),
          };
        } else {
          snake.pop();
        }
      }

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw snake
        snake.forEach((segment, idx) => {
          ctx.fillStyle = "#00ff00";
          ctx.shadowColor = "#00ff00";
          ctx.shadowBlur = 10;
          ctx.fillRect(
            segment.x * gridSize,
            segment.y * gridSize,
            gridSize - 1,
            gridSize - 1
          );
          ctx.shadowBlur = 0;
        });

        // Draw food
        ctx.fillStyle = "#ff00ff";
        ctx.shadowColor = "#ff00ff";
        ctx.shadowBlur = 10;
        ctx.fillRect(
          food.x * gridSize,
          food.y * gridSize,
          gridSize - 1,
          gridSize - 1
        );
        ctx.shadowBlur = 0;

        // Update score display
        scoreDisplay.textContent = `Score: ${score}`;
      }

      function showGameOver() {
        gameActive = false;
        gameOverDiv.style.display = "flex";
      }

      function restartGame() {
        snake = [{ x: 10, y: 10 }];
        direction = { x: 0, y: 0 };
        score = 0;
        food = {
          x: Math.floor(Math.random() * tileCount),
          y: Math.floor(Math.random() * tileCount),
        };
        gameActive = true;
        gameOverDiv.style.display = "none";
        gameLoop();
      }

      document.addEventListener("keydown", (event) => {
        switch (event.key) {
          case "ArrowUp":
            if (direction.y === 0) direction = { x: 0, y: -1 };
            break;
          case "ArrowDown":
            if (direction.y === 0) direction = { x: 0, y: 1 };
            break;
          case "ArrowLeft":
            if (direction.x === 0) direction = { x: -1, y: 0 };
            break;
          case "ArrowRight":
            if (direction.x === 0) direction = { x: 1, y: 0 };
            break;
        }
      });

      gameLoop();
    </script>
  </body>
</html>
